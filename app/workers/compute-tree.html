<!doctype html>
<html>
<head>
  <script>
  const electron = require('electron');
  const nj = require('neighbor-joining');

  electron.ipcRenderer.on('set-data', (e, data) => {
    var taxa = data.nodes.filter(d => d.seq).map(d => ({
      name: d.id,
      genotype: d.id
    }));
    tree = {};
    ['tn93', 'snps'].forEach(type => {
      var RNJ = new nj.RapidNeighborJoining(data.distance_matrix[type], taxa);
      RNJ.run();
      tree[type] = RNJ.getAsNewick();
    });
    electron.ipcRenderer.send('set-tree', tree);
    electron.remote.getCurrentWindow().close();
  });

  electron.ipcRenderer.send('get-data');
  </script>
</head>
</html>
